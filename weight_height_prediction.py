# -*- coding: utf-8 -*-
"""Weight height Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1ZWEJNVnmUFg_uYkvVShUybuJkUkF-l8d
"""

#import libraries
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import sklearn
import warnings
warnings.filterwarnings('ignore')

df = pd.read_csv("/content/weight-height.csv")
df

"""#Handling missing values"""

df.isnull().sum()

df.isna().any()

"""#Basic understanding of dataset"""

df.shape

df.columns

df.info()

df.dtypes

#basic statistical information
df.describe()

"""#Value counts for categorical columns"""

df['Gender'] = df.Gender.map({0:'Male',1:'Female'})

df.Gender.value_counts()

"""#Dataset Splitting"""

x = df.iloc[:, 1:2].values
y = df.iloc[:, 2:3].values

"""#Splitting the data into training and testing set"""

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test =train_test_split(x,y,test_size=0.2,random_state =2)

"""#linear Regression Model"""

from sklearn.linear_model import LinearRegression
#creating object for linear regression
reg=LinearRegression()
#fitting the linear regression model
reg.fit(x_train,y_train)

# Predict on the test data: y_pred
y_pred = reg.predict(x_test)
y_pred

"""#Saving The model"""

import pickle

# Saving the model to the pickle file
pickle.dump(reg, open('model.pkl', 'wb'))

# Loading model to predict the results
model = pickle.load(open('model.pkl', 'rb'))

